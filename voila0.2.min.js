/**
 * Voila Javascript Client API
 * https://github.com/mbst/voila-js
 * Provided by MetaBroadcast
 * v0.2
 *
 * Plugins and licenses.
 * ---------------------
 * Qwery - A Blazing Fast query selector engine
 * https://github.com/ded/qwery
 * copyright Dustin Diaz & Jacob Thornton 2011
 * MIT License
 * ---------------------
 * jXHR.js (JSON-P XHR)
 * v0.1 Â© Kyle Simpson
 * MIT License
 */(function(a,b){typeof module!="undefined"?module.exports=b():typeof define=="function"&&typeof define.amd=="object"?define(b):this[a]=b()})("Voila",function(){var a="Submitted. Please check your browsers network log to confirm success.",b=function(a,b){function i(a){g=setTimeout(function(){var b=null,d=a.target.attributes;for(e=d.length;e--;)d[e].nodeName==="data-content"&&(b=d[e].nodeValue);c.logHover(b,function(a){a.error?console.log(a.error):console.log(a.success)})},h)}function j(){clearTimeout(g)}var c=this,d=null,e=0,f=0,g=null,h=250;this.apiKey=null;this.version="1.0";this.content=null;this.url="https://voila.metabroadcast.com";this.hoverItems=[];this.trackingId=null;this.referrer=null;this.logging=!0;a&&a.hoverTimeout&&(h=a.hoverTimeout);a&&a.apiKey&&(this.apiKey=a.apiKey);a&&a.version&&(this.version=a.version);a&&a.content&&(this.content=a.content);a&&a.host&&(a&&a.host.indexOf("http")===-1?this.url="https://"+a.host:this.url=a.host);if(a&&a.hoverItems)for(e=a.hoverItems.length;e--;){d=qwery(a.hoverItems[e]);for(f=d.length;f--;){try{d[f].addEventListener("mouseover",i);d[f].addEventListener("mouseout",j)}catch(k){d[f].attachEvent("mouseover",i);d[f].attachEvent("mouseout",j)}this.hoverItems.push(d[f])}}a&&a.trackingId&&(this.parent=a.trackingId);document.referrer&&(this.referrer=document.referrer);a&&a.logging&&(this.logging=a.logging)};b.prototype.pageLoad=function(a){var b=this;b.getTracking(function(c){c.error||b.logging===!0&&b.logLoad();a&&a(c)})};b.prototype.setContentId=function(a){this.content=a};b.prototype.setContentUri=function(a){this.content=a};b.prototype.getContent=function(a,b){var c=this,d=c.content,e=new jXHR,f=c.url+"/"+c.version+"/content?apiKey="+c.apiKey;a&&a.content&&(d=a.content);d.indexOf("http")!==-1?f+="&uri="+d:f+="&id="+d;a&&a.annotations&&(f+="&annotations="+a.annotations.join(","));e.onerror=function(a,c){b&&b({error:a})};e.onreadystatechange=function(a){e.readyState===4&&b&&b({success:a})};f+="&callback=?";e.open("GET",f);e.send()};b.prototype.getTracking=function(a){var b=this,c=new jXHR,d=b.url+"/"+b.version+"/tracking?apiKey="+b.apiKey;c.onerror=function(b,c){a&&a({error:b})};c.onreadystatechange=function(d){if(c.readyState===4){if(d.tracking_id){b.trackingId=d.tracking_id;a&&a({success:d.tracking_id});return}a&&a({error:"No tracking id found"})}};b.content&&(b.content.indexOf("http")!==-1?d+="&contentUri="+b.content:d+="&contentId="+b.content);b.parent&&(d+="&parentTrackingId="+b.parent);d+="&callback=?";c.open("GET",d);c.send()};b.prototype.logLoad=function(b){var d=this,f=[{name:"url",value:window.location.href}],g=null,h=null;c();d.trackingId&&f.push[{name:"tracking_id",value:d.trackingId}];if(d.content){f||(f=[]);d.content.indexOf("http")!==-1?f.push({name:"x-purple-external-uri",value:d.content}):f.push({name:"x-purple-id",value:d.content})}d.referrer&&f.push({name:"referrer",value:d.referrer});g=e({url:d.url+"/"+d.version+"/log?apiKey="+d.apiKey+"&event=page-load",id:"voila-pageLog",inputs:f});g.submit();b&&b({success:a})};b.prototype.logHover=function(b,d){var f=this,g=[{name:"url",value:window.location.href}],h=null,i=f.content;c();f.trackingId&&g.push({name:"tracking_id",value:f.trackingId});b&&b.content&&(i=b.content);i.indexOf("http")!==-1?g.push({name:"x-purple-external-uri",value:i}):g.push({name:"x-purple-id",value:i});f.referrer&&g.push({name:"referrer",value:f.referrer});h=e({url:f.url+"/"+f.version+"/log?apiKey="+f.apiKey+"&event=tv-listings-hover",id:"voila-itemLog",inputs:g});h.submit();d&&d({success:a})};b.prototype.watching=function(b,d){var f=this,g=null,h=f.content;c();b&&b.content&&(h=b.content);h.indexOf("http")!==-1?inputs=[{name:"uri",value:h}]:inputs=[{name:"id",value:h}];g=e({url:f.url+"/"+f.version+"/watching/me/@self?apiKey="+f.apiKey,id:"voila-watching",inputs:inputs});g.submit();d&&d({success:a})};b.prototype.notWatching=function(b,d){var f=this,g=[{name:"http_action",value:"DELETE"}],h=f.content,i=f.url+"/"+f.version+"/watching/me/@self/",j=null;c();b&&b.content&&(h=b.content);h.indexOf("http")!==-1?i+="uri:"+h:i+="id:"+h;i+="?apiKey="+f.apiKey;j=e({url:i,id:"voila-watching",inputs:g});j.submit();d&&d({success:a})};b.prototype.currentlyWatching=function(a,b){var c=this,d=c.content,e=new jXHR,f=!1,g=c.url+"/"+c.version+"/watching/me/@self?apiKey="+c.apiKey+"&callback=?",h=0;a&&a.content&&(d=a.content);e.onerror=function(a,c){b&&b({error:a})};e.onreadystatechange=function(a){if(e.readyState===4&&a.watching&&a.watching.length>0){for(h=a.watching.length;h--;)if(a.watching[h].target.id===d){f=!0;break}b&&b({success:f})}};e.open("GET",g);e.send()};b.prototype.cookieOptOut=function(a){var b=this,c=new jXHR,d=b.url+"/"+b.version+"/optout/set?apiKey="+b.apiKey;c.onerror=function(b,c){a&&a({error:b})};c.onreadystatechange=function(b){c.readyState===2&&a&&a({success:b})};c.open("GET",d);c.send()};b.prototype.cookieOptIn=function(a){var b=this,c=new jXHR,d=b.url+"/"+b.version+"/optout/remove?apiKey="+b.apiKey;c.onerror=function(b,c){a&&a({error:b})};c.onreadystatechange=function(b){c.readyState===2&&a&&a({success:!0})};c.open("GET",d);c.send()};b.prototype.cookieOptStatus=function(a){var b=this,c=new jXHR,d=b.url+"/"+b.version+"/optout?apiKey="+b.apiKey+"&callback=?";c.onerror=function(b,c){a&&a({error:b})};c.onreadystatechange=function(b){c.readyState===4&&a&&a({success:b})};c.open("GET",d);c.send()};var c=function(a){qwery("#voilaframe").length!==0&&d();var b=document.createElement("iframe");b.setAttribute("id","voilaframe");b.style.width=0;b.style.height=0;b.style.visibility="hidden";b.style.borderWidth=0;b.style.position="absolute";b.style.left="-9999px";b.style.top="-9999px";document.body.appendChild(b);a&&a({success:!0})},d=function(){document.body.removeChild(qwery("#voilaframe")[0])},e=function(a){var b=this,c=0,d=null;if(!a||!a.url||!a.id)return!1;d=document.createElement("form");d.setAttribute("id",a.id);d.setAttribute("target","voilaframe");d.setAttribute("method","POST");d.setAttribute("action",a.url);d.style.width=0;d.style.height=0;d.style.visibility="hidden";d.style.borderWidth=0;d.style.position="absolute";d.style.left="-9999px";d.style.top="-9999px";if(a&&a.inputs)for(c=a.inputs.length;c--;)d.appendChild(g(a.inputs[c]));return d},f=function(a){document.body.removeChild(qwery("#"+a)[0])},g=function(a){var b=document.createElement("input");b.setAttribute("type","hidden");b.setAttribute("name",a.name);b.setAttribute("value",a.value);return b};return b});(function(a,b){typeof module!="undefined"?module.exports=b():typeof define=="function"&&typeof define.amd=="object"?define(b):this[a]=b()})("qwery",function(){function C(){this.c={}}function H(a){return D.g(a)||D.s(a,"(^|\\s+)"+a+"(\\s+|$)",1)}function I(a,b){var c=0,d=a.length;for(;c<d;c++)b(a[c])}function J(a){for(var b=[],c=0,d=a.length;c<d;++c)V(a[c])?b=b.concat(a[c]):b[b.length]=a[c];return b}function K(a){var b=0,c=a.length,d=[];for(;b<c;b++)d[b]=a[b];return d}function L(a){while(a=a.previousSibling)if(a[h]==1)break;return a}function M(a){return a.match(A)}function N(a,b,c,d,e,f,i,l,m,n,o){var p,q,r,s,t;if(this[h]!==1)return!1;if(b&&b!=="*"&&this[g]&&this[g].toLowerCase()!==b)return!1;if(c&&(q=c.match(j))&&q[1]!==this.id)return!1;if(c&&(t=c.match(k)))for(p=t.length;p--;)if(!H(t[p].slice(1)).test(this.className))return!1;if(m&&Y.pseudos[m]&&!Y.pseudos[m](this,o))return!1;if(d&&!i){s=this.attributes;for(r in s)if(Object.prototype.hasOwnProperty.call(s,r)&&(s[r].name||r)==e)return this}return d&&!P(f,_(this,e)||"",i)?!1:this}function O(a){return E.g(a)||E.s(a,a.replace(t,"\\$1"))}function P(a,b,c){switch(a){case"=":return b==c;case"^=":return b.match(F.g("^="+c)||F.s("^="+c,"^"+O(c),1));case"$=":return b.match(F.g("$="+c)||F.s("$="+c,O(c)+"$",1));case"*=":return b.match(F.g(c)||F.s(c,O(c),1));case"~=":return b.match(F.g("~="+c)||F.s("~="+c,"(?:^|\\s+)"+O(c)+"(?:\\s+|$)",1));case"|=":return b.match(F.g("|="+c)||F.s("|="+c,"^"+O(c)+"(-|$)",1))}return 0}function Q(a,b){var c=[],e=[],f,i,j,k,m,n,o,p,q=b,r=G.g(a)||G.s(a,a.split(z)),s=a.match(y);if(!r.length)return c;k=(r=r.slice(0)).pop();r.length&&(j=r[r.length-1].match(l))&&(q=X(b,j[1]));if(!q)return c;o=M(k);n=q!==b&&q[h]!==9&&s&&/^[+~]$/.test(s[s.length-1])?function(a){while(q=q.nextSibling)q[h]==1&&(o[1]?o[1]==q[g].toLowerCase():1)&&(a[a.length]=q);return a}([]):q[d](o[1]||"*");for(f=0,i=n.length;f<i;f++)if(p=N.apply(n[f],o))c[c.length]=p;if(!r.length)return c;I(c,function(a){S(a,r,s)&&(e[e.length]=a)});return e}function R(a,b,c){if(T(b))return a==b;if(V(b))return!!~J(b).indexOf(a);var d=b.split(","),e,f;while(b=d.pop()){e=G.g(b)||G.s(b,b.split(z));f=b.match(y);e=e.slice(0);if(N.apply(a,M(e.pop()))&&(!e.length||S(a,e,f,c)))return!0}return!1}function S(a,b,c,d){function f(a,d,g){while(g=B[c[d]](g,a))if(T(g)&&N.apply(g,M(b[d]))){if(!d)return g;if(e=f(g,d-1,g))return e}}var e;return(e=f(a,b.length-1,a))&&(!d||$(e,d))}function T(a,b){return a&&typeof a=="object"&&(b=a[h])&&(b==1||b==9)}function U(a){var b=[],c,d;a:for(c=0;c<a.length;++c){for(d=0;d<b.length;++d)if(b[d]==a[c])continue a;b[b.length]=a[c]}return b}function V(a){return typeof a=="object"&&isFinite(a.length)}function W(b){return b?typeof b=="string"?Y(b)[0]:!b[h]&&V(b)?b[0]:b:a}function X(a,b,c){return a[h]===9?a.getElementById(b):a.ownerDocument&&((c=a.ownerDocument.getElementById(b))&&$(c,a)&&c||!$(a,a.ownerDocument)&&i('[id="'+b+'"]',a)[0])}function Y(a,b){var e,f,g=W(b);if(!g||!a)return[];if(a===window||T(a))return!b||a!==window&&T(g)&&$(a,g)?[a]:[];if(a&&V(a))return J(a);if(e=a.match(x)){if(e[1])return(f=X(g,e[1]))?[f]:[];if(e[2])return K(g[d](e[2]));if(ab&&e[3])return K(g[c](e[3]))}return i(a,g)}function Z(a,b){return function(c){var d,e;if(p.test(c)){if(a[h]!==9){(e=d=a.getAttribute("id"))||a.setAttribute("id",e="__qwerymeupscotty");c='[id="'+e+'"]'+c;b(a.parentNode||a,c,!0);d||a.removeAttribute("id")}return}c.length&&b(a,c,!1)}}var a=document,b=a.documentElement,c="getElementsByClassName",d="getElementsByTagName",e="querySelectorAll",f="useNativeQSA",g="tagName",h="nodeType",i,j=/#([\w\-]+)/,k=/\.[\w\-]+/g,l=/^#([\w\-]+)$/,m=/^\.([\w\-]+)$/,n=/^([\w\-]+)$/,o=/^([\w]+)?\.([\w\-]+)$/,p=/(^|,)\s*[>~+]/,q=/^\s+|\s*([,\s\+\~>]|$)\s*/g,r=/[\s\>\+\~]/,s=/(?![\s\w\-\/\?\&\=\:\.\(\)\!,@#%<>\{\}\$\*\^'"]*\]|[\s\w\+\-]*\))/,t=/([.*+?\^=!:${}()|\[\]\/\\])/g,u=/^(\*|[a-z0-9]+)?(?:([\.\#]+[\w\-\.#]+)?)/,v=/\[([\w\-]+)(?:([\|\^\$\*\~]?\=)['"]?([ \w\-\/\?\&\=\:\.\(\)\!,@#%<>\{\}\$\*\^]+)["']?)?\]/,w=/:([\w\-]+)(\(['"]?([^()]+)['"]?\))?/,x=new RegExp(l.source+"|"+n.source+"|"+m.source),y=new RegExp("("+r.source+")"+s.source,"g"),z=new RegExp(r.source+s.source),A=new RegExp(u.source+"("+v.source+")?"+"("+w.source+")?"),B={" ":function(a){return a&&a!==b&&a.parentNode},">":function(a,b){return a&&a.parentNode==b.parentNode&&a.parentNode},"~":function(a){return a&&a.previousSibling},"+":function(a,b,c,d){return a?(c=L(a))&&(d=L(b))&&c==d&&c:!1}};C.prototype={g:function(a){return this.c[a]||undefined},s:function(a,b,c){b=c?new RegExp(b):b;return this.c[a]=b}};var D=new C,E=new C,F=new C,G=new C,$="compareDocumentPosition"in b?function(a,b){return(b.compareDocumentPosition(a)&16)==16}:"contains"in b?function(a,c){c=c[h]===9||c==window?b:c;return c!==a&&c.contains(a)}:function(a,b){while(a=a.parentNode)if(a===b)return 1;return 0},_=function(){var b=a.createElement("p");return(b.innerHTML='<a href="#x">x</a>')&&b.firstChild.getAttribute("href")!="#x"?function(a,b){return b==="class"?a.className:b==="href"||b==="src"?a.getAttribute(b,2):a.getAttribute(b)}:function(a,b){return a.getAttribute(b)}}(),ab=!!a[c],bb=a.querySelector&&a[e],cb=function(a,b){var c=[],d,f;try{if(b[h]===9||!p.test(a))return K(b[e](a));I(d=a.split(","),Z(b,function(a,b){f=a[e](b);f.length==1?c[c.length]=f.item(0):f.length&&(c=c.concat(K(f)))}));return d.length>1&&c.length>1?U(c):c}catch(g){}return db(a,b)},db=function(a,b){var c=[],e,f,g,i,j,k;a=a.replace(q,"$1");if(f=a.match(o)){j=H(f[2]);e=b[d](f[1]||"*");for(g=0,i=e.length;g<i;g++)j.test(e[g].className)&&(c[c.length]=e[g]);return c}I(k=a.split(","),Z(b,function(a,d,e){j=Q(d,a);for(g=0,i=j.length;g<i;g++)if(a[h]===9||e||$(j[g],b))c[c.length]=j[g]}));return k.length>1&&c.length>1?U(c):c},eb=function(a){typeof a[f]!="undefined"&&(i=a[f]?bb?cb:db:db)};eb({useNativeQSA:!0});Y.configure=eb;Y.uniq=U;Y.is=R;Y.pseudos={};return Y});(function(a){var b=a.setTimeout,c=a.document,d=0;a.jXHR=function(){function j(){try{h.parentNode.removeChild(h)}catch(a){}}function k(){f=!1;e="";j();h=null;n(0)}function l(a){console.log(a);try{i.onerror.call(i,a,e)}catch(b){throw new Error(a)}}function m(){if(this.readyState&&this.readyState!=="complete"&&this.readyState!=="loaded"||f)return;this.onload=this.onreadystatechange=null;f=!0;i.readyState!==4&&i.readyState===2&&l("Script failed to load ["+e+"].");j()}function n(a,b){b=b||[];i.readyState=a;typeof i.onreadystatechange=="function"&&i.onreadystatechange.apply(i,b)}var e,f,g,h,i=null;i={onerror:null,onreadystatechange:null,readyState:0,open:function(b,c){k();internal_callback="cb"+d++;(function(b){a.jXHR[b]=function(){try{n.call(i,4,arguments)}catch(c){i.readyState=-1;l("Script failed to run ["+e+"].")}a.jXHR[b]=null}})(internal_callback);e=c.replace(/=\?/,"=jXHR."+internal_callback);n(1)},send:function(){b(function(){h=c.createElement("script");h.setAttribute("type","text/javascript");h.onload=h.onreadystatechange=function(){m.call(h)};h.setAttribute("src",e);c.getElementsByTagName("head")[0].appendChild(h)},0);n(2)},setRequestHeader:function(){},getResponseHeader:function(){return""},getAllResponseHeaders:function(){return[]}};k();return i}})(window);