/**
 * Voila Javascript Client API
 * https://github.com/mbst/voila-js
 * Provided by MetaBroadcast
 * v0.2
 *
 * Plugins and licenses.
 * ---------------------
 * Qwery - A Blazing Fast query selector engine
 * https://github.com/ded/qwery
 * copyright Dustin Diaz & Jacob Thornton 2011
 * MIT License
 * ---------------------
 * jXHR.js (JSON-P XHR)
 * v0.1 Â© Kyle Simpson
 * MIT License
 */(function(e,t){typeof module!="undefined"?module.exports=t():typeof define=="function"&&typeof define.amd=="object"?define(t):this[e]=t()})("Voila",function(){var e="Submitted. Please check your browsers network log to confirm success.",t=function(e,t){function a(e){o=setTimeout(function(){var t=null,r=e.target.attributes;for(i=r.length;i--;)r[i].nodeName==="data-content"&&(t=r[i].nodeValue);n.logHover(t,function(e){e.error})},u)}function f(){clearTimeout(o)}var n=this,r=null,i=0,s=0,o=null,u=250;if(!e)throw new Error("No arguments supplied");this.apiKey=null;this.version="1.0";this.content=null;this.url="https://voila.metabroadcast.com";this.hoverItems=[];this.trackingId=null;this.referrer=null;this.logging=!0;this.userCookie={name:!1,value:!1};this.timeout=2e3;e&&e.hoverTimeout&&(u=e.hoverTimeout);e&&e.apiKey&&(this.apiKey=e.apiKey);e&&e.version&&(this.version=e.version);e&&e.content&&(this.content=e.content);e&&e.host&&(e&&e.host.indexOf("http")===-1?this.url="https://"+e.host:this.url=e.host);if(e&&e.hoverItems)for(i=e.hoverItems.length;i--;){r=qwery(e.hoverItems[i]);for(s=r.length;s--;){try{r[s].addEventListener("mouseover",a);r[s].addEventListener("mouseout",f)}catch(l){r[s].attachEvent("mouseover",a);r[s].attachEvent("mouseout",f)}this.hoverItems.push(r[s])}}e&&e.trackingId&&(this.parent=e.trackingId);document.referrer&&(this.referrer=document.referrer);e&&typeof e.logging!="undefined"&&(this.logging=e.logging);e&&e.userCookieName&&(this.userCookie.name=e.userCookieName);e&&e.timeout&&(this.timeout=e.timeout)};t.prototype.pageLoad=function(e){var t=this;t.content?t.getTracking(function(n){if(!n.error){t.trackingId=n.success;t.logging===!0&&t.logLoad()}e&&e(n)}):t.logLoad(function(){e&&e({success:null})})};t.prototype.setContentId=function(e){this.content=e};t.prototype.setContentUri=function(e){this.content=e};t.prototype.getContent=function(e,t){var n=this,r=n.content,i=new jXHR,s=n.url+"/"+n.version+"/content?apiKey="+n.apiKey;e&&e.content&&(r=e.content);r.indexOf("http")!==-1?s+="&uri="+r:s+="&id="+r;e&&e.annotations&&(s+="&annotations="+e.annotations.join(","));var o=n.getCookie(n.userCookie.name);o&&(s+="&X-User-Id="+o);i.timeout=n.timeout;i.onerror=function(e,n){t&&t({error:e})};i.onreadystatechange=function(e){i.readyState===4&&t&&t({success:e})};s+="&callback=?";i.open("GET",s);i.send()};t.prototype.getTracking=function(e){var t=this,n=new jXHR,r=t.url+"/"+t.version+"/tracking?apiKey="+t.apiKey;n.timeout=t.timeout;n.onerror=function(t,n){e&&e({error:t})};n.onreadystatechange=function(r){if(n.readyState===4){if(r.tracking_id){t.trackingId=r.tracking_id;e&&e({success:r.tracking_id});return}e&&e({error:"No tracking id found"})}};t.content&&(t.content.indexOf("http")!==-1?r+="&contentUri="+t.content:r+="&contentId="+t.content);t.parent&&(r+="&parentTrackingId="+t.parent);var i=t.getCookie(t.userCookie.name);i&&(r+="&X-User-Id="+i);r+="&callback=?";n.open("GET",r);n.send()};t.prototype.logLoad=function(e){var t=this,n=new jXHR,r=null,i=!1,s=t.url;n.timeout=t.timeout;n.onerror=function(t,n){e&&e({error:t})};s=s+"/"+t.version+"/log?apiKey="+encodeURIComponent(t.apiKey)+"&event=page-load";t.trackingId&&(s+="&tracking_id="+encodeURIComponent(t.trackingId));if(t.content){i||(i=[]);t.content.indexOf("http")!==-1?s+="&x-purple-external-uri="+encodeURIComponent(t.content):s+="&x-purple-id="+encodeURIComponent(t.content)}var o=t.getCookie(t.userCookie.name);o&&(s+="&X-User-Id="+encodeURIComponent(o));t.referrer&&(s+="&referrer="+encodeURIComponent(t.referrer));s+="&cb="+(new Date).getTime();n.open("GET",s);n.send()};t.prototype.logHover=function(e,t){var n=this,r=new jXHR,i=n.content,s=n.url;r.timeout=n.timeout;r.onerror=function(e,n){t&&t({error:e})};s=s+"/"+n.version+"/log?apiKey="+encodeURIComponent(n.apiKey)+"&event=tv-listings-hover";n.trackingId&&(s+="&tracking_id="+encodeURIComponent(n.trackingId));e&&e.content&&(i=e.content);i.indexOf("http")!==-1?s+="&x-purple-external-uri="+encodeURIComponent(i):s+="&x-purple-id="+encodeURIComponent(i);var o=n.getCookie(n.userCookie.name);o&&(s+="&X-User-Id="+encodeURIComponent(o));n.referrer&&(s+="&referrer="+encodeURIComponent(n.referrer));s+="&cb="+(new Date).getTime();r.open("GET",s);r.send()};t.prototype.watching=function(e,t){var n=this,r=new jXHR,i=n.content,s=n.url;r.timeout=n.timeout;r.onerror=function(e,n){t&&t({error:e})};s=s+"/"+n.version+"/log?apiKey="+encodeURIComponent(n.apiKey)+"&event=content-play";n.trackingId&&(s+="&tracking_id="+encodeURIComponent(n.trackingId));e&&e.content&&(i=e.content);i.indexOf("http")!==-1?s+="&x-purple-external-uri="+encodeURIComponent(i):s+="&x-purple-id="+encodeURIComponent(i);var o=n.getCookie(n.userCookie.name);o&&(s+="&X-User-Id="+encodeURIComponent(o));n.referrer&&(s+="&referrer="+encodeURIComponent(n.referrer));s+="&cb="+(new Date).getTime();r.open("GET",s);r.send()};t.prototype.notWatching=function(e,t){t&&t({success:!0})};t.prototype.currentlyWatching=function(e,t){t&&t({success:!0})};t.prototype.suggestionsFeedback=function(e,t){var n=this,r=n.url;r=r+"/"+n.version+"/suggestions/feedback/me/@self?apiKey="+n.apiKey;n.trackingId&&(r+="&tracking_id="+encodeURIComponent(n.trackingId));e&&e.id&&(r+="&id="+encodeURIComponent(e.id));e&&e.action&&(r+="&action="+encodeURIComponent(e.action));var i=n.getCookie(n.userCookie.name);i&&(r+="&X-User-Id="+encodeURIComponent(i));n.referrer&&(r+="&referrer="+encodeURIComponent(n.referrer));r+="&cb="+(new Date).getTime();ajax.open("GET",r);ajax.send()};t.prototype.cookieOptOut=function(e){var t=this,n=new jXHR,r=t.url+"/"+t.version+"/optout/set?apiKey="+t.apiKey+"&callback=?";n.timeout=t.timeout;n.onerror=function(t,n){e&&e({error:t})};n.onreadystatechange=function(t){n.readyState===4&&e&&e({success:t})};n.open("GET",r);n.send()};t.prototype.cookieOptIn=function(e){var t=this,n=new jXHR,r=t.url+"/"+t.version+"/optout/remove?apiKey="+t.apiKey+"&callback=?";n.timeout=t.timeout;n.onerror=function(t,n){e&&e({error:t})};n.onreadystatechange=function(t){n.readyState===4&&e&&e({success:t})};n.open("GET",r);n.send()};t.prototype.cookieOptStatus=function(e){var t=this,n=new jXHR,r=t.url+"/"+t.version+"/optout?apiKey="+t.apiKey+"&callback=?";n.timeout=t.timeout;n.onerror=function(t,n){e&&e({error:t})};n.onreadystatechange=function(t){n.readyState===4&&e&&e({success:t})};n.open("GET",r);n.send()};t.prototype.getCookie=function(e){var t=this,n=t.userCookie.name,r=document.cookie,i={},s=!1;e&&(n=e);if(r.length>0&&r.indexOf(";")!==-1){r=r.split(";");for(var o=r.length;o--;){r[o].substr(0,1)===" "&&(r[o]=r[o].substr(1));if(r[o].indexOf("=")!==-1){r[o]=r[o].split("=");var u=r[o][0];i[u]=!1;r[o].splice(0,1);r[o].length>1?r[o]=r[o].join("="):r[o]=r[o][0];i[u]=r[o]}}i[e]&&(s=i[e])}return s};var n=function(e){qwery("#voilaframe").length!==0&&r();var t=document.createElement("iframe"),n='<!DOCTYPE html><html><head><link rel="canonical" href="'+window.location.href+'" /></head><body></body></html>';t.setAttribute("id","voilaframe");t.name="voilaframe";t.style.width=0;t.style.height=0;t.style.visibility="hidden";t.style.borderWidth=0;t.style.position="absolute";t.style.left="-9999px";t.style.top="-9999px";t.src="about:blank";try{t.contentWindow.document.open("text/html","replace");t.contentWindow.document.write(n);t.contentWindow.document.close()}catch(i){}document.body.appendChild(t);t.contentWindow.name="voilaframe";e&&e({success:t});return t},r=function(){document.body.removeChild(qwery("#voilaframe")[0])},i=function(e){var t=this,n=0,r=null;if(!e||!e.url||!e.id)return!1;r=qwery("#"+e.id);r.length>0&&s(e.id);r=document.createElement("form");r.setAttribute("id",e.id);r.setAttribute("target","voilaframe");r.setAttribute("method","POST");r.setAttribute("action",e.url+"&cb="+(new Date).getTime());r.style.width=0;r.style.height=0;r.style.visibility="hidden";r.style.borderWidth=0;r.style.position="absolute";r.style.left="-9999px";r.style.top="-9999px";if(e&&e.inputs)for(n=e.inputs.length;n--;)r.appendChild(o(e.inputs[n]));document.body.appendChild(r);return r},s=function(e){document.body.removeChild(qwery("#"+e)[0])},o=function(e){var t=document.createElement("input");t.setAttribute("type","hidden");t.setAttribute("name",e.name);t.setAttribute("value",e.value);return t};return t});(function(e,t){typeof module!="undefined"?module.exports=t():typeof define=="function"&&typeof define.amd=="object"?define(t):this[e]=t()})("qwery",function(){function L(){this.c={}}function D(e){return A.g(e)||A.s(e,"(^|\\s+)"+e+"(\\s+|$)",1)}function P(e,t){var n=0,r=e.length;for(;n<r;n++)t(e[n])}function H(e){for(var t=[],n=0,r=e.length;n<r;++n)$(e[n])?t=t.concat(e[n]):t[t.length]=e[n];return t}function B(e){var t=0,n=e.length,r=[];for(;t<n;t++)r[t]=e[t];return r}function j(e){while(e=e.previousSibling)if(e[u]==1)break;return e}function F(e){return e.match(C)}function I(e,t,n,r,i,s,a,c,h,p,d){var v,m,g,y,b;if(this[u]!==1)return!1;if(t&&t!=="*"&&this[o]&&this[o].toLowerCase()!==t)return!1;if(n&&(m=n.match(f))&&m[1]!==this.id)return!1;if(n&&(b=n.match(l)))for(v=b.length;v--;)if(!D(b[v].slice(1)).test(this.className))return!1;if(h&&Q.pseudos[h]&&!Q.pseudos[h](this,d))return!1;if(r&&!a){y=this.attributes;for(g in y)if(Object.prototype.hasOwnProperty.call(y,g)&&(y[g].name||g)==i)return this}return r&&!R(s,Z(this,i)||"",a)?!1:this}function q(e){return O.g(e)||O.s(e,e.replace(b,"\\$1"))}function R(e,t,n){switch(e){case"=":return t==n;case"^=":return t.match(M.g("^="+n)||M.s("^="+n,"^"+q(n),1));case"$=":return t.match(M.g("$="+n)||M.s("$="+n,q(n)+"$",1));case"*=":return t.match(M.g(n)||M.s(n,q(n),1));case"~=":return t.match(M.g("~="+n)||M.s("~="+n,"(?:^|\\s+)"+q(n)+"(?:\\s+|$)",1));case"|=":return t.match(M.g("|="+n)||M.s("|="+n,"^"+q(n)+"(-|$)",1))}return 0}function U(e,t){var n=[],i=[],s,a,f,l,h,p,d,v,m=t,g=_.g(e)||_.s(e,e.split(N)),y=e.match(T);if(!g.length)return n;l=(g=g.slice(0)).pop();g.length&&(f=g[g.length-1].match(c))&&(m=K(t,f[1]));if(!m)return n;d=F(l);p=m!==t&&m[u]!==9&&y&&/^[+~]$/.test(y[y.length-1])?function(e){while(m=m.nextSibling)m[u]==1&&(d[1]?d[1]==m[o].toLowerCase():1)&&(e[e.length]=m);return e}([]):m[r](d[1]||"*");for(s=0,a=p.length;s<a;s++)if(v=I.apply(p[s],d))n[n.length]=v;if(!g.length)return n;P(n,function(e){W(e,g,y)&&(i[i.length]=e)});return i}function z(e,t,n){if(X(t))return e==t;if($(t))return!!~H(t).indexOf(e);var r=t.split(","),i,s;while(t=r.pop()){i=_.g(t)||_.s(t,t.split(N));s=t.match(T);i=i.slice(0);if(I.apply(e,F(i.pop()))&&(!i.length||W(e,i,s,n)))return!0}return!1}function W(e,t,n,r){function s(e,r,o){while(o=k[n[r]](o,e))if(X(o)&&I.apply(o,F(t[r]))){if(!r)return o;if(i=s(o,r-1,o))return i}}var i;return(i=s(e,t.length-1,e))&&(!r||Y(i,r))}function X(e,t){return e&&typeof e=="object"&&(t=e[u])&&(t==1||t==9)}function V(e){var t=[],n,r;e:for(n=0;n<e.length;++n){for(r=0;r<t.length;++r)if(t[r]==e[n])continue e;t[t.length]=e[n]}return t}function $(e){return typeof e=="object"&&isFinite(e.length)}function J(t){return t?typeof t=="string"?Q(t)[0]:!t[u]&&$(t)?t[0]:t:e}function K(e,t,n){return e[u]===9?e.getElementById(t):e.ownerDocument&&((n=e.ownerDocument.getElementById(t))&&Y(n,e)&&n||!Y(e,e.ownerDocument)&&a('[id="'+t+'"]',e)[0])}function Q(e,t){var i,s,o=J(t);if(!o||!e)return[];if(e===window||X(e))return!t||e!==window&&X(o)&&Y(e,o)?[e]:[];if(e&&$(e))return H(e);if(i=e.match(x)){if(i[1])return(s=K(o,i[1]))?[s]:[];if(i[2])return B(o[r](i[2]));if(et&&i[3])return B(o[n](i[3]))}return a(e,o)}function G(e,t){return function(n){var r,i;if(v.test(n)){if(e[u]!==9){(i=r=e.getAttribute("id"))||e.setAttribute("id",i="__qwerymeupscotty");n='[id="'+i+'"]'+n;t(e.parentNode||e,n,!0);r||e.removeAttribute("id")}return}n.length&&t(e,n,!1)}}var e=document,t=e.documentElement,n="getElementsByClassName",r="getElementsByTagName",i="querySelectorAll",s="useNativeQSA",o="tagName",u="nodeType",a,f=/#([\w\-]+)/,l=/\.[\w\-]+/g,c=/^#([\w\-]+)$/,h=/^\.([\w\-]+)$/,p=/^([\w\-]+)$/,d=/^([\w]+)?\.([\w\-]+)$/,v=/(^|,)\s*[>~+]/,m=/^\s+|\s*([,\s\+\~>]|$)\s*/g,g=/[\s\>\+\~]/,y=/(?![\s\w\-\/\?\&\=\:\.\(\)\!,@#%<>\{\}\$\*\^'"]*\]|[\s\w\+\-]*\))/,b=/([.*+?\^=!:${}()|\[\]\/\\])/g,w=/^(\*|[a-z0-9]+)?(?:([\.\#]+[\w\-\.#]+)?)/,E=/\[([\w\-]+)(?:([\|\^\$\*\~]?\=)['"]?([ \w\-\/\?\&\=\:\.\(\)\!,@#%<>\{\}\$\*\^]+)["']?)?\]/,S=/:([\w\-]+)(\(['"]?([^()]+)['"]?\))?/,x=new RegExp(c.source+"|"+p.source+"|"+h.source),T=new RegExp("("+g.source+")"+y.source,"g"),N=new RegExp(g.source+y.source),C=new RegExp(w.source+"("+E.source+")?"+"("+S.source+")?"),k={" ":function(e){return e&&e!==t&&e.parentNode},">":function(e,t){return e&&e.parentNode==t.parentNode&&e.parentNode},"~":function(e){return e&&e.previousSibling},"+":function(e,t,n,r){return e?(n=j(e))&&(r=j(t))&&n==r&&n:!1}};L.prototype={g:function(e){return this.c[e]||undefined},s:function(e,t,n){t=n?new RegExp(t):t;return this.c[e]=t}};var A=new L,O=new L,M=new L,_=new L,Y="compareDocumentPosition"in t?function(e,t){return(t.compareDocumentPosition(e)&16)==16}:"contains"in t?function(e,n){n=n[u]===9||n==window?t:n;return n!==e&&n.contains(e)}:function(e,t){while(e=e.parentNode)if(e===t)return 1;return 0},Z=function(){var t=e.createElement("p");return(t.innerHTML='<a href="#x">x</a>')&&t.firstChild.getAttribute("href")!="#x"?function(e,t){return t==="class"?e.className:t==="href"||t==="src"?e.getAttribute(t,2):e.getAttribute(t)}:function(e,t){return e.getAttribute(t)}}(),et=!!e[n],tt=e.querySelector&&e[i],nt=function(e,t){var n=[],r,s;try{if(t[u]===9||!v.test(e))return B(t[i](e));P(r=e.split(","),G(t,function(e,t){s=e[i](t);s.length==1?n[n.length]=s.item(0):s.length&&(n=n.concat(B(s)))}));return r.length>1&&n.length>1?V(n):n}catch(o){}return rt(e,t)},rt=function(e,t){var n=[],i,s,o,a,f,l;e=e.replace(m,"$1");if(s=e.match(d)){f=D(s[2]);i=t[r](s[1]||"*");for(o=0,a=i.length;o<a;o++)f.test(i[o].className)&&(n[n.length]=i[o]);return n}P(l=e.split(","),G(t,function(e,r,i){f=U(r,e);for(o=0,a=f.length;o<a;o++)if(e[u]===9||i||Y(f[o],t))n[n.length]=f[o]}));return l.length>1&&n.length>1?V(n):n},it=function(e){typeof e[s]!="undefined"&&(a=e[s]?tt?nt:rt:rt)};it({useNativeQSA:!0});Q.configure=it;Q.uniq=V;Q.is=z;Q.pseudos={};return Q});(function(e){var t=e.setTimeout,n=e.document,r=0;e.jXHR=function(){function f(){try{u.parentNode.removeChild(u)}catch(e){}}function l(){s=!1;i="";f();u=null;p(0)}function c(e){try{a.onerror.call(a,e,i)}catch(t){throw new Error(e)}}function h(){if(this.readyState&&this.readyState!=="complete"&&this.readyState!=="loaded"||s)return;this.onload=this.onreadystatechange=null;s=!0;a.readyState!==4&&a.readyState===2&&c("Script failed to load ["+i+"].");f()}function p(e,t){t=t||[];a.readyState=e;typeof a.onreadystatechange=="function"&&a.onreadystatechange.apply(a,t)}var i,s,o,u,a=null;a={onerror:null,onreadystatechange:null,readyState:0,open:function(t,n){l();internal_callback="cb"+r++;(function(t){e.jXHR[t]=function(){try{p.call(a,4,arguments)}catch(n){a.readyState=-1;c("Script failed to run ["+i+"].")}e.jXHR[t]=null}})(internal_callback);i=n.replace(/=\?/,"=jXHR."+internal_callback);p(1)},send:function(){t(function(){u=n.createElement("script");u.setAttribute("type","text/javascript");u.onload=u.onreadystatechange=function(){h.call(u)};u.setAttribute("src",i);n.getElementsByTagName("head")[0].appendChild(u)},0);p(2)},setRequestHeader:function(){},getResponseHeader:function(){return""},getAllResponseHeaders:function(){return[]}};l();return a}})(window);